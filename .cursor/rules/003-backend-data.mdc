---
alwaysApply: true
---
description: 백엔드 및 데이터베이스 규칙 (Supabase, Server Actions)

# 기술 스택 (Tech Stack)
- **BaaS**: Supabase (Auth, DB, Storage, Edge Functions)
- **API Strategy**: Server Actions (Next.js 16)
- **Tooling**: Cursor MCP (Model Context Protocol)

# Supabase & MCP 활용 규칙 (가장 중요)
1. **스키마 확인 필수 (READ SCHEMA FIRST)**:
   - 데이터베이스 관련 코드를 짜기 전에, **무조건 `supabase_mcp` 툴을 사용하여 현재 테이블 구조를 먼저 조회**하세요.
   - 테이블 이름이나 컬럼 이름을 절대 추측해서 작성하지 마세요. (환각 방지)

2. **Server Actions 사용**:
   - 데이터를 저장/수정/삭제할 때는 `pages/api`나 `route.ts`를 만들지 마세요.
   - Next.js의 **Server Actions (`'use server'`)** 기능을 사용하여 함수 형태로 구현하세요.

3. **보안 (RLS & Auth)**:
   - 모든 새 테이블에는 **RLS (Row Level Security)** 정책을 켜세요.
   - "누구나 볼 수 있음" 또는 "로그인한 사람만 수정 가능" 같은 정책을 SQL 작성 시 함께 포함하세요.
   - Supabase Auth(`@supabase/ssr`)를 사용하여 사용자 세션을 관리하세요.

4. **타입 안전성**:
   - Supabase에서 생성된 타입을 활용하여 TypeScript 인터페이스를 정의하세요. `any` 타입 사용을 지양하세요.